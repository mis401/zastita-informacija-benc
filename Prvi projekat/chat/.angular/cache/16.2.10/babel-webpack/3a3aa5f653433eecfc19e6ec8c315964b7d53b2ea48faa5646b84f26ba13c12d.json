{"ast":null,"code":"export class RC4 {\n  constructor() {\n    this.S = null;\n  }\n  encrypt(message) {\n    if (this.S.length === 0) {\n      this.S = this.KSA(import.meta.env.NG_APP_SECRET);\n    }\n    const coded = this.PRGA(message);\n    return coded;\n  }\n  KSA(key) {\n    let S = new Uint8Array(0);\n    for (let i = 0; i < 256; i++) {\n      S[i] = i;\n    }\n    let j = 0;\n    for (let i = 0; i < 256; i++) {\n      j = (j + S[i] + key.charCodeAt(i % key.length)) % 256;\n      let tmp = new Uint8Array(0);\n      tmp[0] = S[i];\n      S[i] = S[j];\n      S[j] = tmp[0];\n    }\n    return S;\n  }\n  PRGA(message) {\n    let i = 0;\n    let j = 0;\n    if (this.S.length === 0) {\n      this.S = this.KSA(import.meta.env.NG_APP_SECRET);\n    }\n    let cipher = new Uint8Array(0);\n    for (let n = 0; n < message.length; n++) {\n      i = (i + 1) % 256;\n      j = (j + this.S[i]) % 256;\n      let tmp = new Uint8Array(0);\n      tmp[0] = this.S[i];\n      this.S[i] = this.S[j];\n      this.S[j] = tmp[0];\n      let k = this.S[(this.S[i] + this.S[j]) % 256];\n      cipher;\n    }\n    let coded = cipher.join('');\n    return coded;\n  }\n}","map":{"version":3,"names":["RC4","constructor","S","encrypt","message","length","KSA","import","meta","env","NG_APP_SECRET","coded","PRGA","key","Uint8Array","i","j","charCodeAt","tmp","cipher","n","k","join"],"sources":["C:\\Users\\MihajloBencun\\Desktop\\Faks\\Zastita informacija\\Prvi projekat\\chat\\src\\app\\chat\\RC4.ts"],"sourcesContent":["export class RC4 {\r\n    private S: Uint8Array | null;\r\n    constructor() {\r\n        this.S = null\r\n    }\r\n    public encrypt(message: string){\r\n        if (this.S.length === 0) {\r\n            this.S = this.KSA(import.meta.env.NG_APP_SECRET);\r\n        }\r\n        const coded = this.PRGA(message);\r\n        return coded;\r\n    }\r\n    private KSA(key: string) {\r\n        let S = new Uint8Array(0);\r\n        for (let i = 0; i < 256; i++) {\r\n            S[i] = i;\r\n        }\r\n        let j = 0;\r\n        for (let i = 0; i < 256; i++) {\r\n            j = (j + S[i] + key.charCodeAt(i % key.length)) % 256;\r\n            let tmp = new Uint8Array(0);\r\n            tmp[0] = S[i]\r\n            S[i] = S[j];\r\n            S[j] = tmp[0];\r\n        }\r\n        return S;\r\n    }\r\n    private PRGA(message: string) {\r\n        let i = 0;\r\n        let j = 0;\r\n        if (this.S.length === 0) {\r\n            this.S = this.KSA(import.meta.env.NG_APP_SECRET);\r\n        }\r\n        let cipher = new Uint8Array(0);\r\n        for (let n = 0; n < message.length; n++) {\r\n            i = (i + 1) % 256;\r\n            j = (j + this.S[i]) % 256;\r\n            let tmp = new Uint8Array(0);\r\n            tmp[0] = this.S[i];\r\n            this.S[i] = this.S[j];\r\n            this.S[j] = tmp[0];\r\n            let k = this.S[(this.S[i] + this.S[j]) % 256];\r\n            cipher\r\n        }\r\n        let coded = cipher.join('');\r\n        return coded;\r\n    }\r\n}\r\n\r\n\r\n"],"mappings":"AAAA,OAAM,MAAOA,GAAG;EAEZC,YAAA;IACI,IAAI,CAACC,CAAC,GAAG,IAAI;EACjB;EACOC,OAAOA,CAACC,OAAe;IAC1B,IAAI,IAAI,CAACF,CAAC,CAACG,MAAM,KAAK,CAAC,EAAE;MACrB,IAAI,CAACH,CAAC,GAAG,IAAI,CAACI,GAAG,CAACC,MAAM,CAACC,IAAI,CAACC,GAAG,CAACC,aAAa,CAAC;;IAEpD,MAAMC,KAAK,GAAG,IAAI,CAACC,IAAI,CAACR,OAAO,CAAC;IAChC,OAAOO,KAAK;EAChB;EACQL,GAAGA,CAACO,GAAW;IACnB,IAAIX,CAAC,GAAG,IAAIY,UAAU,CAAC,CAAC,CAAC;IACzB,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,GAAG,EAAEA,CAAC,EAAE,EAAE;MAC1Bb,CAAC,CAACa,CAAC,CAAC,GAAGA,CAAC;;IAEZ,IAAIC,CAAC,GAAG,CAAC;IACT,KAAK,IAAID,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,GAAG,EAAEA,CAAC,EAAE,EAAE;MAC1BC,CAAC,GAAG,CAACA,CAAC,GAAGd,CAAC,CAACa,CAAC,CAAC,GAAGF,GAAG,CAACI,UAAU,CAACF,CAAC,GAAGF,GAAG,CAACR,MAAM,CAAC,IAAI,GAAG;MACrD,IAAIa,GAAG,GAAG,IAAIJ,UAAU,CAAC,CAAC,CAAC;MAC3BI,GAAG,CAAC,CAAC,CAAC,GAAGhB,CAAC,CAACa,CAAC,CAAC;MACbb,CAAC,CAACa,CAAC,CAAC,GAAGb,CAAC,CAACc,CAAC,CAAC;MACXd,CAAC,CAACc,CAAC,CAAC,GAAGE,GAAG,CAAC,CAAC,CAAC;;IAEjB,OAAOhB,CAAC;EACZ;EACQU,IAAIA,CAACR,OAAe;IACxB,IAAIW,CAAC,GAAG,CAAC;IACT,IAAIC,CAAC,GAAG,CAAC;IACT,IAAI,IAAI,CAACd,CAAC,CAACG,MAAM,KAAK,CAAC,EAAE;MACrB,IAAI,CAACH,CAAC,GAAG,IAAI,CAACI,GAAG,CAACC,MAAM,CAACC,IAAI,CAACC,GAAG,CAACC,aAAa,CAAC;;IAEpD,IAAIS,MAAM,GAAG,IAAIL,UAAU,CAAC,CAAC,CAAC;IAC9B,KAAK,IAAIM,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGhB,OAAO,CAACC,MAAM,EAAEe,CAAC,EAAE,EAAE;MACrCL,CAAC,GAAG,CAACA,CAAC,GAAG,CAAC,IAAI,GAAG;MACjBC,CAAC,GAAG,CAACA,CAAC,GAAG,IAAI,CAACd,CAAC,CAACa,CAAC,CAAC,IAAI,GAAG;MACzB,IAAIG,GAAG,GAAG,IAAIJ,UAAU,CAAC,CAAC,CAAC;MAC3BI,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAChB,CAAC,CAACa,CAAC,CAAC;MAClB,IAAI,CAACb,CAAC,CAACa,CAAC,CAAC,GAAG,IAAI,CAACb,CAAC,CAACc,CAAC,CAAC;MACrB,IAAI,CAACd,CAAC,CAACc,CAAC,CAAC,GAAGE,GAAG,CAAC,CAAC,CAAC;MAClB,IAAIG,CAAC,GAAG,IAAI,CAACnB,CAAC,CAAC,CAAC,IAAI,CAACA,CAAC,CAACa,CAAC,CAAC,GAAG,IAAI,CAACb,CAAC,CAACc,CAAC,CAAC,IAAI,GAAG,CAAC;MAC7CG,MAAM;;IAEV,IAAIR,KAAK,GAAGQ,MAAM,CAACG,IAAI,CAAC,EAAE,CAAC;IAC3B,OAAOX,KAAK;EAChB"},"metadata":{},"sourceType":"module","externalDependencies":[]}