{"ast":null,"code":"export class RC4 {\n  constructor() {\n    this.S = null;\n  }\n  encrypt(message) {\n    if (!this.S) {\n      this.S = this.KSA(import.meta.env.NG_APP_SECRET);\n    }\n    const coded = this.PRGA(message);\n    return coded;\n  }\n  KSA(key) {\n    let S = new Uint8Array(0);\n    for (let i = 0; i < 256; i++) {\n      S[i] = i;\n    }\n    let j = 0;\n    for (let i = 0; i < 256; i++) {\n      j = (j + S[i] + key.charCodeAt(i % key.length)) % 256;\n      let tmp = new Uint8Array(0);\n      tmp[0] = S[i];\n      S[i] = S[j];\n      S[j] = tmp[0];\n    }\n    return S;\n  }\n  PRGA(message) {\n    let i = 0;\n    let j = 0;\n    if (!this.S) {\n      this.S = this.KSA(import.meta.env.NG_APP_SECRET);\n    }\n    let cipher = new Uint8Array(0);\n    let messageArray = message.split('');\n    for (let n = 0; n < message.length; n++) {\n      i = (i + 1) % 256;\n      j = (j + this.S[i]) % 256;\n      let tmp = new Uint8Array(0);\n      tmp[0] = this.S[i];\n      this.S[i] = this.S[j];\n      this.S[j] = tmp[0];\n      let k = this.S[(this.S[i] + this.S[j]) % 256];\n    }\n    let coded = cipher.join('');\n    return coded;\n  }\n}","map":{"version":3,"names":["RC4","constructor","S","encrypt","message","KSA","import","meta","env","NG_APP_SECRET","coded","PRGA","key","Uint8Array","i","j","charCodeAt","length","tmp","cipher","messageArray","split","n","k","join"],"sources":["C:\\Users\\MihajloBencun\\Desktop\\Faks\\Zastita informacija\\Prvi projekat\\chat\\src\\app\\chat\\RC4.ts"],"sourcesContent":["export class RC4 {\r\n    private S: Uint8Array | null;\r\n    constructor() {\r\n        this.S = null;\r\n    }\r\n    public encrypt(message: string){\r\n        if (!this.S) {\r\n            this.S = this.KSA(import.meta.env.NG_APP_SECRET);\r\n        }\r\n        const coded = this.PRGA(message);\r\n        return coded;\r\n    }\r\n    private KSA(key: string) {\r\n        let S = new Uint8Array(0);\r\n        for (let i = 0; i < 256; i++) {\r\n            S[i] = i;\r\n        }\r\n        let j = 0;\r\n        for (let i = 0; i < 256; i++) {\r\n            j = (j + S[i] + key.charCodeAt(i % key.length)) % 256;\r\n            let tmp = new Uint8Array(0);\r\n            tmp[0] = S[i]\r\n            S[i] = S[j];\r\n            S[j] = tmp[0];\r\n        }\r\n        return S;\r\n    }\r\n    private PRGA(message: string) {\r\n        let i = 0;\r\n        let j = 0;\r\n        if (!this.S) {\r\n            this.S = this.KSA(import.meta.env.NG_APP_SECRET);\r\n        }\r\n        let cipher = new Uint8Array(0);\r\n        let messageArray = message.split('');\r\n        \r\n        for (let n = 0; n < message.length; n++) {\r\n            i = (i + 1) % 256;\r\n            j = (j + this.S[i]) % 256;\r\n            let tmp = new Uint8Array(0);\r\n            tmp[0] = this.S[i];\r\n            this.S[i] = this.S[j];\r\n            this.S[j] = tmp[0];\r\n            let k = this.S[(this.S[i] + this.S[j]) % 256];\r\n            \r\n        }\r\n        let coded = cipher.join('');\r\n        return coded;\r\n    }\r\n}\r\n\r\n\r\n"],"mappings":"AAAA,OAAM,MAAOA,GAAG;EAEZC,YAAA;IACI,IAAI,CAACC,CAAC,GAAG,IAAI;EACjB;EACOC,OAAOA,CAACC,OAAe;IAC1B,IAAI,CAAC,IAAI,CAACF,CAAC,EAAE;MACT,IAAI,CAACA,CAAC,GAAG,IAAI,CAACG,GAAG,CAACC,MAAM,CAACC,IAAI,CAACC,GAAG,CAACC,aAAa,CAAC;;IAEpD,MAAMC,KAAK,GAAG,IAAI,CAACC,IAAI,CAACP,OAAO,CAAC;IAChC,OAAOM,KAAK;EAChB;EACQL,GAAGA,CAACO,GAAW;IACnB,IAAIV,CAAC,GAAG,IAAIW,UAAU,CAAC,CAAC,CAAC;IACzB,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,GAAG,EAAEA,CAAC,EAAE,EAAE;MAC1BZ,CAAC,CAACY,CAAC,CAAC,GAAGA,CAAC;;IAEZ,IAAIC,CAAC,GAAG,CAAC;IACT,KAAK,IAAID,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,GAAG,EAAEA,CAAC,EAAE,EAAE;MAC1BC,CAAC,GAAG,CAACA,CAAC,GAAGb,CAAC,CAACY,CAAC,CAAC,GAAGF,GAAG,CAACI,UAAU,CAACF,CAAC,GAAGF,GAAG,CAACK,MAAM,CAAC,IAAI,GAAG;MACrD,IAAIC,GAAG,GAAG,IAAIL,UAAU,CAAC,CAAC,CAAC;MAC3BK,GAAG,CAAC,CAAC,CAAC,GAAGhB,CAAC,CAACY,CAAC,CAAC;MACbZ,CAAC,CAACY,CAAC,CAAC,GAAGZ,CAAC,CAACa,CAAC,CAAC;MACXb,CAAC,CAACa,CAAC,CAAC,GAAGG,GAAG,CAAC,CAAC,CAAC;;IAEjB,OAAOhB,CAAC;EACZ;EACQS,IAAIA,CAACP,OAAe;IACxB,IAAIU,CAAC,GAAG,CAAC;IACT,IAAIC,CAAC,GAAG,CAAC;IACT,IAAI,CAAC,IAAI,CAACb,CAAC,EAAE;MACT,IAAI,CAACA,CAAC,GAAG,IAAI,CAACG,GAAG,CAACC,MAAM,CAACC,IAAI,CAACC,GAAG,CAACC,aAAa,CAAC;;IAEpD,IAAIU,MAAM,GAAG,IAAIN,UAAU,CAAC,CAAC,CAAC;IAC9B,IAAIO,YAAY,GAAGhB,OAAO,CAACiB,KAAK,CAAC,EAAE,CAAC;IAEpC,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGlB,OAAO,CAACa,MAAM,EAAEK,CAAC,EAAE,EAAE;MACrCR,CAAC,GAAG,CAACA,CAAC,GAAG,CAAC,IAAI,GAAG;MACjBC,CAAC,GAAG,CAACA,CAAC,GAAG,IAAI,CAACb,CAAC,CAACY,CAAC,CAAC,IAAI,GAAG;MACzB,IAAII,GAAG,GAAG,IAAIL,UAAU,CAAC,CAAC,CAAC;MAC3BK,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAChB,CAAC,CAACY,CAAC,CAAC;MAClB,IAAI,CAACZ,CAAC,CAACY,CAAC,CAAC,GAAG,IAAI,CAACZ,CAAC,CAACa,CAAC,CAAC;MACrB,IAAI,CAACb,CAAC,CAACa,CAAC,CAAC,GAAGG,GAAG,CAAC,CAAC,CAAC;MAClB,IAAIK,CAAC,GAAG,IAAI,CAACrB,CAAC,CAAC,CAAC,IAAI,CAACA,CAAC,CAACY,CAAC,CAAC,GAAG,IAAI,CAACZ,CAAC,CAACa,CAAC,CAAC,IAAI,GAAG,CAAC;;IAGjD,IAAIL,KAAK,GAAGS,MAAM,CAACK,IAAI,CAAC,EAAE,CAAC;IAC3B,OAAOd,KAAK;EAChB"},"metadata":{},"sourceType":"module","externalDependencies":[]}