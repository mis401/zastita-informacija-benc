{"ast":null,"code":"export class RC4 {\n  constructor() {\n    this.S = new Uint8Array(0);\n  }\n  encrypt(message) {\n    if (this.S.length === 0) {\n      this.S = this.KSA(import.meta.env.NG_APP_SECRET);\n    }\n    const coded = this.PRGA(message);\n    return coded;\n  }\n  KSA(key) {\n    let S = new Uint8Array();\n    for (let i = 0; i < 256; i++) {\n      S[i] = i;\n    }\n    let j = 0;\n    for (let i = 0; i < 256; i++) {\n      j = (j + S[i] + key.charCodeAt(i % key.length)) % 256;\n      let tmp = S[i];\n      S[i] = S[j];\n      S[j] = tmp;\n    }\n    return S;\n  }\n  PRGA(message) {\n    let i = 0;\n    let j = 0;\n    if (this.S.length === 0) {\n      this.S = this.KSA(import.meta.env.NG_APP_SECRET);\n    }\n    let cipher = [];\n    for (let n = 0; n < message.length; n++) {\n      i = (i + 1) % 256;\n      j = (j + this.S[i]) % 256;\n      let tmp = this.S[i];\n      this.S[i] = this.S[j];\n      this.S[j] = tmp;\n      let k = this.S[(this.S[i] + this.S[j]) % 256];\n      cipher.push(message.charCodeAt(n) ^ k);\n    }\n    let coded = cipher.join('');\n    return coded;\n  }\n}","map":{"version":3,"names":["RC4","constructor","S","Uint8Array","encrypt","message","length","KSA","import","meta","env","NG_APP_SECRET","coded","PRGA","key","i","j","charCodeAt","tmp","cipher","n","k","push","join"],"sources":["C:\\Users\\MihajloBencun\\Desktop\\Faks\\Zastita informacija\\Prvi projekat\\chat\\src\\app\\chat\\RC4.ts"],"sourcesContent":["export class RC4 {\r\n    private S: Uint8Array;\r\n    constructor() {\r\n        this.S = new Uint8Array(0);\r\n    }\r\n    public encrypt(message: string){\r\n        if (this.S.length === 0) {\r\n            this.S = this.KSA(import.meta.env.NG_APP_SECRET);\r\n        }\r\n        const coded = this.PRGA(message);\r\n        return coded;\r\n    }\r\n    private KSA(key: string) {\r\n        let S = new Uint8Array();\r\n        for (let i = 0; i < 256; i++) {\r\n            S[i] = i;\r\n        }\r\n        let j = 0;\r\n        for (let i = 0; i < 256; i++) {\r\n            j = (j + S[i] + key.charCodeAt(i % key.length)) % 256;\r\n            let tmp: number = S[i];\r\n            S[i] = S[j];\r\n            S[j] = tmp;\r\n        }\r\n        return S;\r\n    }\r\n    private PRGA(message: string) {\r\n        let i = 0;\r\n        let j = 0;\r\n        if (this.S.length === 0) {\r\n            this.S = this.KSA(import.meta.env.NG_APP_SECRET);\r\n        }\r\n        let cipher = [];\r\n        for (let n = 0; n < message.length; n++) {\r\n            i = (i + 1) % 256;\r\n            j = (j + this.S[i]) % 256;\r\n            let tmp: number = this.S[i];\r\n            this.S[i] = this.S[j];\r\n            this.S[j] = tmp;\r\n            let k = this.S[(this.S[i] + this.S[j]) % 256];\r\n            cipher.push(message.charCodeAt(n) ^ k);\r\n        }\r\n        let coded = cipher.join('');\r\n        return coded;\r\n    }\r\n}\r\n\r\n\r\n"],"mappings":"AAAA,OAAM,MAAOA,GAAG;EAEZC,YAAA;IACI,IAAI,CAACC,CAAC,GAAG,IAAIC,UAAU,CAAC,CAAC,CAAC;EAC9B;EACOC,OAAOA,CAACC,OAAe;IAC1B,IAAI,IAAI,CAACH,CAAC,CAACI,MAAM,KAAK,CAAC,EAAE;MACrB,IAAI,CAACJ,CAAC,GAAG,IAAI,CAACK,GAAG,CAACC,MAAM,CAACC,IAAI,CAACC,GAAG,CAACC,aAAa,CAAC;;IAEpD,MAAMC,KAAK,GAAG,IAAI,CAACC,IAAI,CAACR,OAAO,CAAC;IAChC,OAAOO,KAAK;EAChB;EACQL,GAAGA,CAACO,GAAW;IACnB,IAAIZ,CAAC,GAAG,IAAIC,UAAU,EAAE;IACxB,KAAK,IAAIY,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,GAAG,EAAEA,CAAC,EAAE,EAAE;MAC1Bb,CAAC,CAACa,CAAC,CAAC,GAAGA,CAAC;;IAEZ,IAAIC,CAAC,GAAG,CAAC;IACT,KAAK,IAAID,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,GAAG,EAAEA,CAAC,EAAE,EAAE;MAC1BC,CAAC,GAAG,CAACA,CAAC,GAAGd,CAAC,CAACa,CAAC,CAAC,GAAGD,GAAG,CAACG,UAAU,CAACF,CAAC,GAAGD,GAAG,CAACR,MAAM,CAAC,IAAI,GAAG;MACrD,IAAIY,GAAG,GAAWhB,CAAC,CAACa,CAAC,CAAC;MACtBb,CAAC,CAACa,CAAC,CAAC,GAAGb,CAAC,CAACc,CAAC,CAAC;MACXd,CAAC,CAACc,CAAC,CAAC,GAAGE,GAAG;;IAEd,OAAOhB,CAAC;EACZ;EACQW,IAAIA,CAACR,OAAe;IACxB,IAAIU,CAAC,GAAG,CAAC;IACT,IAAIC,CAAC,GAAG,CAAC;IACT,IAAI,IAAI,CAACd,CAAC,CAACI,MAAM,KAAK,CAAC,EAAE;MACrB,IAAI,CAACJ,CAAC,GAAG,IAAI,CAACK,GAAG,CAACC,MAAM,CAACC,IAAI,CAACC,GAAG,CAACC,aAAa,CAAC;;IAEpD,IAAIQ,MAAM,GAAG,EAAE;IACf,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGf,OAAO,CAACC,MAAM,EAAEc,CAAC,EAAE,EAAE;MACrCL,CAAC,GAAG,CAACA,CAAC,GAAG,CAAC,IAAI,GAAG;MACjBC,CAAC,GAAG,CAACA,CAAC,GAAG,IAAI,CAACd,CAAC,CAACa,CAAC,CAAC,IAAI,GAAG;MACzB,IAAIG,GAAG,GAAW,IAAI,CAAChB,CAAC,CAACa,CAAC,CAAC;MAC3B,IAAI,CAACb,CAAC,CAACa,CAAC,CAAC,GAAG,IAAI,CAACb,CAAC,CAACc,CAAC,CAAC;MACrB,IAAI,CAACd,CAAC,CAACc,CAAC,CAAC,GAAGE,GAAG;MACf,IAAIG,CAAC,GAAG,IAAI,CAACnB,CAAC,CAAC,CAAC,IAAI,CAACA,CAAC,CAACa,CAAC,CAAC,GAAG,IAAI,CAACb,CAAC,CAACc,CAAC,CAAC,IAAI,GAAG,CAAC;MAC7CG,MAAM,CAACG,IAAI,CAACjB,OAAO,CAACY,UAAU,CAACG,CAAC,CAAC,GAAGC,CAAC,CAAC;;IAE1C,IAAIT,KAAK,GAAGO,MAAM,CAACI,IAAI,CAAC,EAAE,CAAC;IAC3B,OAAOX,KAAK;EAChB"},"metadata":{},"sourceType":"module","externalDependencies":[]}