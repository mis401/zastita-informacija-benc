{"ast":null,"code":"import { ElementRef } from '@angular/core';\nimport { EncryptionType } from '../models/algorithms';\nimport { ChangeEncryptionType } from '../store/user.actions';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./chat.service\";\nimport * as i2 from \"@ngrx/store\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nconst _c0 = [\"scrollable\"];\nconst _c1 = [\"messageText\"];\nfunction ChatComponent_div_6_div_1_p_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const m_r3 = i0.ɵɵnextContext(2).$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(m_r3.crypto);\n  }\n}\nfunction ChatComponent_div_6_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 16)(1, \"div\", 17)(2, \"p\", 18);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(4, ChatComponent_div_6_div_1_p_4_Template, 2, 1, \"p\", 19);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const m_r3 = i0.ɵɵnextContext().$implicit;\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(m_r3.text);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.toggleEncryption);\n  }\n}\nfunction ChatComponent_div_6_ng_template_2_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"a\", 25);\n    i0.ɵɵtext(2, \"Preuzmi fajl\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const m_r3 = i0.ɵɵnextContext(2).$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"href\", m_r3.file, i0.ɵɵsanitizeUrl);\n  }\n}\nfunction ChatComponent_div_6_ng_template_2_p_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 26);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const m_r3 = i0.ɵɵnextContext(2).$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(m_r3.crypto);\n  }\n}\nfunction ChatComponent_div_6_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 21)(1, \"div\", 17)(2, \"p\", 22);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\", 18);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(6, ChatComponent_div_6_ng_template_2_div_6_Template, 3, 1, \"div\", 23);\n    i0.ɵɵtemplate(7, ChatComponent_div_6_ng_template_2_p_7_Template, 2, 1, \"p\", 24);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const m_r3 = i0.ɵɵnextContext().$implicit;\n    const ctx_r6 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(m_r3.senderName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(m_r3.text);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", m_r3.file);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r6.toggleEncryption);\n  }\n}\nfunction ChatComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, ChatComponent_div_6_div_1_Template, 5, 2, \"div\", 14);\n    i0.ɵɵtemplate(2, ChatComponent_div_6_ng_template_2_Template, 8, 4, \"ng-template\", null, 15, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const m_r3 = ctx.$implicit;\n    const _r5 = i0.ɵɵreference(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", m_r3.owner == true)(\"ngIfElse\", _r5);\n  }\n}\nexport class ChatComponent {\n  constructor(service, store) {\n    this.service = service;\n    this.store = store;\n    this.myScrollContainer = new ElementRef('scrollable');\n    this.messageTextElement = new ElementRef('messageText');\n    this.messages = [];\n    this.file = null;\n    this.toggleEncryption = false;\n    this.encryptionType = EncryptionType.RC4;\n    this.messages$ = this.service.messageStream.subscribe(message => {\n      console.log(message);\n      this.messages.push(message);\n    });\n    this.messageText = '';\n    window.onbeforeunload = () => this.ngOnDestroy();\n  }\n  ngOnInit() {\n    this.service.connect();\n  }\n  ngOnDestroy() {\n    console.log(`Destroy pozvan`);\n    this.service.disconnect();\n  }\n  ngAfterViewChecked() {\n    this.scrollToBottom();\n  }\n  onFileSelected(event) {\n    this.file = event.target.files[0];\n  }\n  switchEncryption() {\n    if (this.encryptionType === EncryptionType.RC4) {\n      this.encryptionType = EncryptionType.XTEA;\n      this.store.dispatch(ChangeEncryptionType({\n        encryptionType: EncryptionType.XTEA\n      }));\n    } else {\n      this.encryptionType = EncryptionType.RC4;\n      this.store.dispatch(ChangeEncryptionType({\n        encryptionType: EncryptionType.RC4\n      }));\n    }\n  }\n  scrollToBottom() {\n    try {\n      this.myScrollContainer.nativeElement.scrollTop = this.myScrollContainer.nativeElement.scrollHeight;\n    } catch (err) {}\n  }\n  sendMessage() {\n    this.service.sendMessage(this.messageText, this.encryptionType);\n    this.messageText = '';\n  }\n  static #_ = this.ɵfac = function ChatComponent_Factory(t) {\n    return new (t || ChatComponent)(i0.ɵɵdirectiveInject(i1.ChatService), i0.ɵɵdirectiveInject(i2.Store));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ChatComponent,\n    selectors: [[\"app-chat\"]],\n    viewQuery: function ChatComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n        i0.ɵɵviewQuery(_c1, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.myScrollContainer = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.messageTextElement = _t.first);\n      }\n    },\n    decls: 18,\n    vars: 3,\n    consts: [[1, \"h-full\", \"bg-gray-700\"], [1, \"min-h-screen\", \"chat\", \"flex\", \"flex-col-reverse\"], [1, \"inner-chat\"], [\"scrollable\", \"\"], [1, \"chat-card\"], [1, \"h-full\", \"min-h-screen\"], [4, \"ngFor\", \"ngForOf\"], [1, \"input-poruke\", \"flex\", \"flex-row\"], [\"type\", \"text\", \"placeholder\", \"Poruka\", 1, \"w-full\", 3, \"ngModel\", \"keydown.enter\", \"ngModelChange\"], [\"type\", \"reset\", 1, \"bg-green-500\", \"mr-1\", \"ml-2\", 3, \"click\"], [\"type\", \"file\", 3, \"change\"], [\"fileInput\", \"\"], [1, \"bg-orange-500\", \"ml-1\", \"rounded-md\", 3, \"click\"], [1, \"bg-red-500\", \"ml-1\", \"rounded-md\", 3, \"click\"], [\"class\", \"chat-msg-wrap sender\", 4, \"ngIf\", \"ngIfElse\"], [\"receiver\", \"\"], [1, \"chat-msg-wrap\", \"sender\"], [1, \"chat-msg\"], [2, \"margin-bottom\", \"0\"], [\"class\", \"bg-slate-400/25 rounded-md pl-1 pr-1\", \"style\", \"margin-bottom: 0;\", 4, \"ngIf\"], [1, \"bg-slate-400/25\", \"rounded-md\", \"pl-1\", \"pr-1\", 2, \"margin-bottom\", \"0\"], [1, \"chat-msg-wrap\", \"receiver\"], [1, \"text-sm\", \"bg-lime-600/25\", \"rounded-sm\", \"pl-1\", \"pr-1\"], [4, \"ngIf\"], [\"class\", \"bg-lime-800/50 rounded-md pl-1 pr-1\", \"style\", \"margin-bottom: 0;\", 4, \"ngIf\"], [\"target\", \"_blank\", 1, \"text-blue-500\", \"underline\", 3, \"href\"], [1, \"bg-lime-800/50\", \"rounded-md\", \"pl-1\", \"pr-1\", 2, \"margin-bottom\", \"0\"]],\n    template: function ChatComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2, 3)(4, \"div\", 4);\n        i0.ɵɵelement(5, \"div\", 5);\n        i0.ɵɵtemplate(6, ChatComponent_div_6_Template, 4, 2, \"div\", 6);\n        i0.ɵɵelementStart(7, \"div\")(8, \"div\", 7)(9, \"input\", 8);\n        i0.ɵɵlistener(\"keydown.enter\", function ChatComponent_Template_input_keydown_enter_9_listener() {\n          return ctx.sendMessage();\n        })(\"ngModelChange\", function ChatComponent_Template_input_ngModelChange_9_listener($event) {\n          return ctx.messageText = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"button\", 9);\n        i0.ɵɵlistener(\"click\", function ChatComponent_Template_button_click_10_listener() {\n          return ctx.sendMessage();\n        });\n        i0.ɵɵtext(11, \" Po\\u0161alji \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"input\", 10, 11);\n        i0.ɵɵlistener(\"change\", function ChatComponent_Template_input_change_12_listener($event) {\n          return ctx.onFileSelected($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"button\", 12);\n        i0.ɵɵlistener(\"click\", function ChatComponent_Template_button_click_14_listener() {\n          return ctx.toggleEncryption = !ctx.toggleEncryption;\n        });\n        i0.ɵɵtext(15, \"Enkriptovan tekst\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"button\", 13);\n        i0.ɵɵlistener(\"click\", function ChatComponent_Template_button_click_16_listener() {\n          return ctx.switchEncryption();\n        });\n        i0.ɵɵtext(17);\n        i0.ɵɵelementEnd()()()()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngForOf\", ctx.messages);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngModel\", ctx.messageText);\n        i0.ɵɵadvance(8);\n        i0.ɵɵtextInterpolate(ctx.encryptionType);\n      }\n    },\n    dependencies: [i3.NgForOf, i3.NgIf, i4.DefaultValueAccessor, i4.NgControlStatus, i4.NgModel],\n    styles: [\".chat[_ngcontent-%COMP%] {\\n  background-color: #2a323e;\\n  padding: 20px;\\n  border-radius: 5px;\\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\\n  overflow: hidden;\\n}\\n\\n.inner-chat[_ngcontent-%COMP%] {\\n  position: relative;\\n  min-height: 200px;\\n  max-height: 600px;\\n  overflow-y: auto;\\n  overflow-x: hidden;\\n  padding: 10px;\\n  margin-bottom: 10px;\\n  border-radius: 10px;\\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\\n}\\n\\n.chat-msg-wrap[_ngcontent-%COMP%] {\\n  width: 100%;\\n  margin-bottom: 10px;\\n}\\n\\n.chat-msg[_ngcontent-%COMP%] {\\n  width: -moz-fit-content;\\n  width: fit-content;\\n  border: 1px solid #ccc;\\n  padding: 10px;\\n  margin: 5px;\\n  border-radius: 8px;\\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\\n}\\n\\n.receiver[_ngcontent-%COMP%] {\\n  display: flex;\\n  justify-content: flex-start;\\n}\\n\\n.receiver[_ngcontent-%COMP%]   .chat-msg[_ngcontent-%COMP%] {\\n  background-color: #b8dfb5;\\n  color: #333333;\\n}\\n\\n.sender[_ngcontent-%COMP%] {\\n  display: flex;\\n  justify-content: flex-end;\\n}\\n\\n.sender[_ngcontent-%COMP%]   .chat-msg[_ngcontent-%COMP%] {\\n  background-color: #d2effc;\\n  color: #333333;\\n}\\n\\n.chat-card[_ngcontent-%COMP%] {\\n  background-color: #475569;\\n  border-radius: 10px;\\n  padding: 20px;\\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\\n}\\n\\n.input-poruke[_ngcontent-%COMP%] {\\n  display: flex;\\n  align-items: center;\\n}\\n\\n.mat-form-field[_ngcontent-%COMP%] {\\n  width: 100%;\\n  margin-right: 10px;\\n}\\n\\nbutton[type=reset][_ngcontent-%COMP%] {\\n  color: #ffffff;\\n  border-radius: 5px;\\n  padding: 10px 20px;\\n}\\n\\n.spinner[_ngcontent-%COMP%] {\\n  position: absolute;\\n  top: 50%;\\n  left: 50%;\\n  transform: translate(-50%, -50%);\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY2hhdC9jaGF0LmNvbXBvbmVudC5zY3NzIiwid2VicGFjazovLy4vLi4vLi4vLi4vLi4vLi4vWmFzdGl0YSUyMGluZm9ybWFjaWphL1BydmklMjBwcm9qZWthdC96YXN0aXRhLWluZm9ybWFjaWphLWJlbmMvUHJ2aSUyMHByb2pla2F0L2NoYXQvc3JjL2FwcC9jaGF0L2NoYXQuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0E7RUFHSSx5QkFBQTtFQUNBLGFBQUE7RUFDQSxrQkFBQTtFQUNBLHdDQUFBO0VBQ0EsZ0JBQUE7QUNGSjs7QURLQTtFQUNJLGtCQUFBO0VBQ0EsaUJBQUE7RUFDQSxpQkFBQTtFQUNBLGdCQUFBO0VBQ0Esa0JBQUE7RUFDQSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSxtQkFBQTtFQUNBLHdDQUFBO0FDRko7O0FES0U7RUFFRSxXQUFBO0VBQ0EsbUJBQUE7QUNISjs7QURNRTtFQUNFLHVCQUFBO0VBQUEsa0JBQUE7RUFDQSxzQkFBQTtFQUNBLGFBQUE7RUFDQSxXQUFBO0VBQ0Esa0JBQUE7RUFDQSx3Q0FBQTtBQ0hKOztBRE1FO0VBQ0UsYUFBQTtFQUNBLDJCQUFBO0FDSEo7O0FETUU7RUFDRSx5QkFBQTtFQUNBLGNBQUE7QUNISjs7QURNRTtFQUNFLGFBQUE7RUFDQSx5QkFBQTtBQ0hKOztBRE9FO0VBQ0UseUJBQUE7RUFDQSxjQUFBO0FDSko7O0FET0U7RUFDRSx5QkFBQTtFQUNBLG1CQUFBO0VBQ0EsYUFBQTtFQUNBLHdDQUFBO0FDSko7O0FET0U7RUFDRSxhQUFBO0VBQ0EsbUJBQUE7QUNKSjs7QURPRTtFQUNFLFdBQUE7RUFDQSxrQkFBQTtBQ0pKOztBRE9FO0VBQ0UsY0FBQTtFQUNBLGtCQUFBO0VBQ0Esa0JBQUE7QUNKSjs7QURPRTtFQUNFLGtCQUFBO0VBQ0EsUUFBQTtFQUNBLFNBQUE7RUFDQSxnQ0FBQTtBQ0pKIiwic291cmNlc0NvbnRlbnQiOlsiXHJcbi5jaGF0IHtcclxuICAgIFxyXG4gICAgXHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMmEzMjNlO1xyXG4gICAgcGFkZGluZzogMjBweDtcclxuICAgIGJvcmRlci1yYWRpdXM6IDVweDtcclxuICAgIGJveC1zaGFkb3c6IDAgMnB4IDRweCByZ2JhKDAsIDAsIDAsIDAuMSk7XHJcbiAgICBvdmVyZmxvdzogaGlkZGVuO1xyXG4gIH1cclxuICBcclxuLmlubmVyLWNoYXR7XHJcbiAgICBwb3NpdGlvbjogcmVsYXRpdmU7XHJcbiAgICBtaW4taGVpZ2h0OiAyMDBweDtcclxuICAgIG1heC1oZWlnaHQ6IDYwMHB4O1xyXG4gICAgb3ZlcmZsb3cteTogYXV0bztcclxuICAgIG92ZXJmbG93LXg6IGhpZGRlbjtcclxuICAgIHBhZGRpbmc6IDEwcHg7XHJcbiAgICBtYXJnaW4tYm90dG9tOiAxMHB4O1xyXG4gICAgYm9yZGVyLXJhZGl1czogMTBweDtcclxuICAgIGJveC1zaGFkb3c6IDAgMnB4IDRweCByZ2JhKDAsIDAsIDAsIDAuMSk7XHJcbn1cclxuXHJcbiAgLmNoYXQtbXNnLXdyYXAge1xyXG4gICAgXHJcbiAgICB3aWR0aDogMTAwJTtcclxuICAgIG1hcmdpbi1ib3R0b206IDEwcHg7XHJcbiAgfVxyXG4gIFxyXG4gIC5jaGF0LW1zZyB7XHJcbiAgICB3aWR0aDogZml0LWNvbnRlbnQ7XHJcbiAgICBib3JkZXI6IDFweCBzb2xpZCAjY2NjO1xyXG4gICAgcGFkZGluZzogMTBweDtcclxuICAgIG1hcmdpbjogNXB4O1xyXG4gICAgYm9yZGVyLXJhZGl1czogOHB4O1xyXG4gICAgYm94LXNoYWRvdzogMCAycHggNHB4IHJnYmEoMCwgMCwgMCwgMC4xKTtcclxuICB9XHJcbiAgXHJcbiAgLnJlY2VpdmVyIHtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtc3RhcnQ7XHJcbiAgfVxyXG4gIFxyXG4gIC5yZWNlaXZlciAuY2hhdC1tc2cge1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogI2I4ZGZiNTtcclxuICAgIGNvbG9yOiAjMzMzMzMzO1xyXG4gIH1cclxuICBcclxuICAuc2VuZGVyIHtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtZW5kO1xyXG4gIH1cclxuICBcclxuICBcclxuICAuc2VuZGVyIC5jaGF0LW1zZyB7XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZDJlZmZjO1xyXG4gICAgY29sb3I6ICMzMzMzMzM7XHJcbiAgfVxyXG4gIFxyXG4gIC5jaGF0LWNhcmQge1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogIzQ3NTU2OTtcclxuICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7XHJcbiAgICBwYWRkaW5nOiAyMHB4O1xyXG4gICAgYm94LXNoYWRvdzogMCA0cHggOHB4IHJnYmEoMCwgMCwgMCwgMC4xKTtcclxuICB9XHJcbiAgXHJcbiAgLmlucHV0LXBvcnVrZSB7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICB9XHJcbiAgXHJcbiAgLm1hdC1mb3JtLWZpZWxkIHtcclxuICAgIHdpZHRoOiAxMDAlO1xyXG4gICAgbWFyZ2luLXJpZ2h0OiAxMHB4O1xyXG4gIH1cclxuICBcclxuICBidXR0b25bdHlwZT1cInJlc2V0XCJdIHtcclxuICAgIGNvbG9yOiAjZmZmZmZmO1xyXG4gICAgYm9yZGVyLXJhZGl1czogNXB4O1xyXG4gICAgcGFkZGluZzogMTBweCAyMHB4O1xyXG4gIH1cclxuXHJcbiAgLnNwaW5uZXJ7XHJcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICB0b3A6IDUwJTtcclxuICAgIGxlZnQ6IDUwJTtcclxuICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpO1xyXG4gIH1cclxuXHJcbiAgIiwiLmNoYXQge1xuICBiYWNrZ3JvdW5kLWNvbG9yOiAjMmEzMjNlO1xuICBwYWRkaW5nOiAyMHB4O1xuICBib3JkZXItcmFkaXVzOiA1cHg7XG4gIGJveC1zaGFkb3c6IDAgMnB4IDRweCByZ2JhKDAsIDAsIDAsIDAuMSk7XG4gIG92ZXJmbG93OiBoaWRkZW47XG59XG5cbi5pbm5lci1jaGF0IHtcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xuICBtaW4taGVpZ2h0OiAyMDBweDtcbiAgbWF4LWhlaWdodDogNjAwcHg7XG4gIG92ZXJmbG93LXk6IGF1dG87XG4gIG92ZXJmbG93LXg6IGhpZGRlbjtcbiAgcGFkZGluZzogMTBweDtcbiAgbWFyZ2luLWJvdHRvbTogMTBweDtcbiAgYm9yZGVyLXJhZGl1czogMTBweDtcbiAgYm94LXNoYWRvdzogMCAycHggNHB4IHJnYmEoMCwgMCwgMCwgMC4xKTtcbn1cblxuLmNoYXQtbXNnLXdyYXAge1xuICB3aWR0aDogMTAwJTtcbiAgbWFyZ2luLWJvdHRvbTogMTBweDtcbn1cblxuLmNoYXQtbXNnIHtcbiAgd2lkdGg6IGZpdC1jb250ZW50O1xuICBib3JkZXI6IDFweCBzb2xpZCAjY2NjO1xuICBwYWRkaW5nOiAxMHB4O1xuICBtYXJnaW46IDVweDtcbiAgYm9yZGVyLXJhZGl1czogOHB4O1xuICBib3gtc2hhZG93OiAwIDJweCA0cHggcmdiYSgwLCAwLCAwLCAwLjEpO1xufVxuXG4ucmVjZWl2ZXIge1xuICBkaXNwbGF5OiBmbGV4O1xuICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtc3RhcnQ7XG59XG5cbi5yZWNlaXZlciAuY2hhdC1tc2cge1xuICBiYWNrZ3JvdW5kLWNvbG9yOiAjYjhkZmI1O1xuICBjb2xvcjogIzMzMzMzMztcbn1cblxuLnNlbmRlciB7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGp1c3RpZnktY29udGVudDogZmxleC1lbmQ7XG59XG5cbi5zZW5kZXIgLmNoYXQtbXNnIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogI2QyZWZmYztcbiAgY29sb3I6ICMzMzMzMzM7XG59XG5cbi5jaGF0LWNhcmQge1xuICBiYWNrZ3JvdW5kLWNvbG9yOiAjNDc1NTY5O1xuICBib3JkZXItcmFkaXVzOiAxMHB4O1xuICBwYWRkaW5nOiAyMHB4O1xuICBib3gtc2hhZG93OiAwIDRweCA4cHggcmdiYSgwLCAwLCAwLCAwLjEpO1xufVxuXG4uaW5wdXQtcG9ydWtlIHtcbiAgZGlzcGxheTogZmxleDtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbn1cblxuLm1hdC1mb3JtLWZpZWxkIHtcbiAgd2lkdGg6IDEwMCU7XG4gIG1hcmdpbi1yaWdodDogMTBweDtcbn1cblxuYnV0dG9uW3R5cGU9cmVzZXRdIHtcbiAgY29sb3I6ICNmZmZmZmY7XG4gIGJvcmRlci1yYWRpdXM6IDVweDtcbiAgcGFkZGluZzogMTBweCAyMHB4O1xufVxuXG4uc3Bpbm5lciB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgdG9wOiA1MCU7XG4gIGxlZnQ6IDUwJTtcbiAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwgLTUwJSk7XG59Il0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n  });\n}","map":{"version":3,"names":["ElementRef","EncryptionType","ChangeEncryptionType","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵadvance","ɵɵtextInterpolate","m_r3","crypto","ɵɵtemplate","ChatComponent_div_6_div_1_p_4_Template","text","ɵɵproperty","ctx_r4","toggleEncryption","file","ɵɵsanitizeUrl","ChatComponent_div_6_ng_template_2_div_6_Template","ChatComponent_div_6_ng_template_2_p_7_Template","senderName","ctx_r6","ChatComponent_div_6_div_1_Template","ChatComponent_div_6_ng_template_2_Template","ɵɵtemplateRefExtractor","owner","_r5","ChatComponent","constructor","service","store","myScrollContainer","messageTextElement","messages","encryptionType","RC4","messages$","messageStream","subscribe","message","console","log","push","messageText","window","onbeforeunload","ngOnDestroy","ngOnInit","connect","disconnect","ngAfterViewChecked","scrollToBottom","onFileSelected","event","target","files","switchEncryption","XTEA","dispatch","nativeElement","scrollTop","scrollHeight","err","sendMessage","_","ɵɵdirectiveInject","i1","ChatService","i2","Store","_2","selectors","viewQuery","ChatComponent_Query","rf","ctx","ɵɵelement","ChatComponent_div_6_Template","ɵɵlistener","ChatComponent_Template_input_keydown_enter_9_listener","ChatComponent_Template_input_ngModelChange_9_listener","$event","ChatComponent_Template_button_click_10_listener","ChatComponent_Template_input_change_12_listener","ChatComponent_Template_button_click_14_listener","ChatComponent_Template_button_click_16_listener"],"sources":["C:\\Users\\MihajloBencun\\Desktop\\Faks\\Zastita informacija\\Prvi projekat\\zastita-informacija-benc\\Prvi projekat\\chat\\src\\app\\chat\\chat.component.ts","C:\\Users\\MihajloBencun\\Desktop\\Faks\\Zastita informacija\\Prvi projekat\\zastita-informacija-benc\\Prvi projekat\\chat\\src\\app\\chat\\chat.component.html"],"sourcesContent":["import { AfterViewChecked, Component, ElementRef, OnDestroy, OnInit, ViewChild } from '@angular/core';\nimport { ChatService } from './chat.service';\nimport { Message } from '../models/message.dto';\nimport { EncryptionType } from '../models/algorithms';\nimport { Store } from '@ngrx/store';\nimport { User } from '../models/user.model';\nimport { UserState } from '../store/user.state';\nimport { ChangeEncryptionType } from '../store/user.actions';\nimport { TigerHash } from '../hash/TigerHash';\n\n@Component({\n  selector: 'app-chat',\n  templateUrl: './chat.component.html',\n  styleUrls: ['./chat.component.scss']\n})\nexport class ChatComponent implements OnInit, OnDestroy, AfterViewChecked{\n  constructor(private service: ChatService, private store: Store<UserState>) {\n    window.onbeforeunload = () => this.ngOnDestroy();\n    \n  }\n  @ViewChild('scrollable') private myScrollContainer: ElementRef = new ElementRef('scrollable');\n  @ViewChild('messageText') private messageTextElement: ElementRef = new ElementRef('messageText');\n\n  messages: Message[] = [];\n  file: File | null = null;\n  toggleEncryption: boolean = false;\n  encryptionType: EncryptionType = EncryptionType.RC4;\n  messages$ = this.service.messageStream.subscribe((message) => {\n    console.log(message);\n    this.messages.push(message);\n  });\n  messageText : string = '';\n  ngOnInit(){\n    this.service.connect();\n    \n  }\n  \n  ngOnDestroy(): void {\n    console.log(`Destroy pozvan`);\n    this.service.disconnect();\n  }\n  ngAfterViewChecked(): void {\n    this.scrollToBottom();\n  }\n\n  onFileSelected(event: any) {\n    this.file = event.target.files[0];\n    \n  }\n\n  switchEncryption(){\n    if (this.encryptionType === EncryptionType.RC4) {\n      this.encryptionType = EncryptionType.XTEA;\n      this.store.dispatch(ChangeEncryptionType({encryptionType: EncryptionType.XTEA}));\n    }\n    else {\n      this.encryptionType = EncryptionType.RC4;\n      this.store.dispatch(ChangeEncryptionType({encryptionType: EncryptionType.RC4}));\n    }\n  }\n  scrollToBottom():void {\n    try {\n        this.myScrollContainer.nativeElement.scrollTop = this.myScrollContainer.nativeElement.scrollHeight;\n    } catch(err) { }                 \n  }\n\n  sendMessage(){\n    this.service.sendMessage(this.messageText, this.encryptionType);\n    this.messageText = '';\n  }\n}\n","<div class=\"h-full bg-gray-700\">\n    <div class=\"min-h-screen chat flex flex-col-reverse\">\n        <div #scrollable class=\"inner-chat\">\n            <div class=\"chat-card\">\n                <div class=\"h-full min-h-screen\">\n\n                </div>\n                <div *ngFor=\"let m of messages\">\n                    <div *ngIf=\"m.owner==true; else receiver\" class=\"chat-msg-wrap sender\">\n                        <div class=\"chat-msg\">\n                            <p style=\"margin-bottom: 0;\">{{m.text}}</p>\n                            <p *ngIf=\"toggleEncryption\" class=\"bg-slate-400/25 rounded-md pl-1 pr-1\" style=\"margin-bottom: 0;\">{{m.crypto}}</p>\n                        </div>\n                    </div>\n                    <ng-template #receiver>\n                        <div class=\"chat-msg-wrap receiver\">\n                            <div class=\"chat-msg\">\n                                <p class=\"text-sm bg-lime-600/25 rounded-sm pl-1 pr-1\">{{m.senderName}}</p>\n                                <p style=\"margin-bottom: 0;\">{{m.text}}</p>\n                                <div *ngIf=\"m.file\">\n                                    <a [href]=\"m.file\" target=\"_blank\" class=\"text-blue-500 underline\">Preuzmi fajl</a>\n                                </div>\n                                <p *ngIf=\"toggleEncryption\" class=\"bg-lime-800/50 rounded-md pl-1 pr-1\" style=\"margin-bottom: 0;\">{{m.crypto}}</p>\n                            </div>\n                        </div>\n                    </ng-template>\n                </div>\n                <div>\n                    <div class=\"input-poruke flex flex-row\">\n                        <input type=\"text\" class=\"w-full\" placeholder=\"Poruka\" (keydown.enter)=\"sendMessage()\" [(ngModel)]=\"messageText\">\n                        <button class=\"bg-green-500 mr-1 ml-2\" type=\"reset\" (click)=\"sendMessage()\">\n                            Pošalji\n                        </button>\n                        <input type=\"file\" (change)=\"onFileSelected($event)\" #fileInput>\n                        <button class=\"bg-orange-500 ml-1 rounded-md\" (click)=\"toggleEncryption = !toggleEncryption\">Enkriptovan tekst</button>\n                        <button class=\"bg-red-500 ml-1 rounded-md\" (click)=\"switchEncryption()\">{{encryptionType}}</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>"],"mappings":"AAAA,SAAsCA,UAAU,QAAsC,eAAe;AAGrG,SAASC,cAAc,QAAQ,sBAAsB;AAIrD,SAASC,oBAAoB,QAAQ,uBAAuB;;;;;;;;;;ICIhCC,EAAA,CAAAC,cAAA,YAAmG;IAAAD,EAAA,CAAAE,MAAA,GAAY;IAAAF,EAAA,CAAAG,YAAA,EAAI;;;;IAAhBH,EAAA,CAAAI,SAAA,GAAY;IAAZJ,EAAA,CAAAK,iBAAA,CAAAC,IAAA,CAAAC,MAAA,CAAY;;;;;IAHvHP,EAAA,CAAAC,cAAA,cAAuE;IAElCD,EAAA,CAAAE,MAAA,GAAU;IAAAF,EAAA,CAAAG,YAAA,EAAI;IAC3CH,EAAA,CAAAQ,UAAA,IAAAC,sCAAA,gBAAmH;IACvHT,EAAA,CAAAG,YAAA,EAAM;;;;;IAF2BH,EAAA,CAAAI,SAAA,GAAU;IAAVJ,EAAA,CAAAK,iBAAA,CAAAC,IAAA,CAAAI,IAAA,CAAU;IACnCV,EAAA,CAAAI,SAAA,GAAsB;IAAtBJ,EAAA,CAAAW,UAAA,SAAAC,MAAA,CAAAC,gBAAA,CAAsB;;;;;IAQtBb,EAAA,CAAAC,cAAA,UAAoB;IACmDD,EAAA,CAAAE,MAAA,mBAAY;IAAAF,EAAA,CAAAG,YAAA,EAAI;;;;IAAhFH,EAAA,CAAAI,SAAA,GAAe;IAAfJ,EAAA,CAAAW,UAAA,SAAAL,IAAA,CAAAQ,IAAA,EAAAd,EAAA,CAAAe,aAAA,CAAe;;;;;IAEtBf,EAAA,CAAAC,cAAA,YAAkG;IAAAD,EAAA,CAAAE,MAAA,GAAY;IAAAF,EAAA,CAAAG,YAAA,EAAI;;;;IAAhBH,EAAA,CAAAI,SAAA,GAAY;IAAZJ,EAAA,CAAAK,iBAAA,CAAAC,IAAA,CAAAC,MAAA,CAAY;;;;;IAPtHP,EAAA,CAAAC,cAAA,cAAoC;IAE2BD,EAAA,CAAAE,MAAA,GAAgB;IAAAF,EAAA,CAAAG,YAAA,EAAI;IAC3EH,EAAA,CAAAC,cAAA,YAA6B;IAAAD,EAAA,CAAAE,MAAA,GAAU;IAAAF,EAAA,CAAAG,YAAA,EAAI;IAC3CH,EAAA,CAAAQ,UAAA,IAAAQ,gDAAA,kBAEM;IACNhB,EAAA,CAAAQ,UAAA,IAAAS,8CAAA,gBAAkH;IACtHjB,EAAA,CAAAG,YAAA,EAAM;;;;;IANqDH,EAAA,CAAAI,SAAA,GAAgB;IAAhBJ,EAAA,CAAAK,iBAAA,CAAAC,IAAA,CAAAY,UAAA,CAAgB;IAC1ClB,EAAA,CAAAI,SAAA,GAAU;IAAVJ,EAAA,CAAAK,iBAAA,CAAAC,IAAA,CAAAI,IAAA,CAAU;IACjCV,EAAA,CAAAI,SAAA,GAAY;IAAZJ,EAAA,CAAAW,UAAA,SAAAL,IAAA,CAAAQ,IAAA,CAAY;IAGdd,EAAA,CAAAI,SAAA,GAAsB;IAAtBJ,EAAA,CAAAW,UAAA,SAAAQ,MAAA,CAAAN,gBAAA,CAAsB;;;;;IAf1Cb,EAAA,CAAAC,cAAA,UAAgC;IAC5BD,EAAA,CAAAQ,UAAA,IAAAY,kCAAA,kBAKM;IACNpB,EAAA,CAAAQ,UAAA,IAAAa,0CAAA,iCAAArB,EAAA,CAAAsB,sBAAA,CAWc;IAClBtB,EAAA,CAAAG,YAAA,EAAM;;;;;IAlBIH,EAAA,CAAAI,SAAA,GAAqB;IAArBJ,EAAA,CAAAW,UAAA,SAAAL,IAAA,CAAAiB,KAAA,SAAqB,aAAAC,GAAA;;;ADO/C,OAAM,MAAOC,aAAa;EACxBC,YAAoBC,OAAoB,EAAUC,KAAuB;IAArD,KAAAD,OAAO,GAAPA,OAAO;IAAuB,KAAAC,KAAK,GAALA,KAAK;IAItB,KAAAC,iBAAiB,GAAe,IAAIhC,UAAU,CAAC,YAAY,CAAC;IAC3D,KAAAiC,kBAAkB,GAAe,IAAIjC,UAAU,CAAC,aAAa,CAAC;IAEhG,KAAAkC,QAAQ,GAAc,EAAE;IACxB,KAAAjB,IAAI,GAAgB,IAAI;IACxB,KAAAD,gBAAgB,GAAY,KAAK;IACjC,KAAAmB,cAAc,GAAmBlC,cAAc,CAACmC,GAAG;IACnD,KAAAC,SAAS,GAAG,IAAI,CAACP,OAAO,CAACQ,aAAa,CAACC,SAAS,CAAEC,OAAO,IAAI;MAC3DC,OAAO,CAACC,GAAG,CAACF,OAAO,CAAC;MACpB,IAAI,CAACN,QAAQ,CAACS,IAAI,CAACH,OAAO,CAAC;IAC7B,CAAC,CAAC;IACF,KAAAI,WAAW,GAAY,EAAE;IAdvBC,MAAM,CAACC,cAAc,GAAG,MAAM,IAAI,CAACC,WAAW,EAAE;EAElD;EAaAC,QAAQA,CAAA;IACN,IAAI,CAAClB,OAAO,CAACmB,OAAO,EAAE;EAExB;EAEAF,WAAWA,CAAA;IACTN,OAAO,CAACC,GAAG,CAAC,gBAAgB,CAAC;IAC7B,IAAI,CAACZ,OAAO,CAACoB,UAAU,EAAE;EAC3B;EACAC,kBAAkBA,CAAA;IAChB,IAAI,CAACC,cAAc,EAAE;EACvB;EAEAC,cAAcA,CAACC,KAAU;IACvB,IAAI,CAACrC,IAAI,GAAGqC,KAAK,CAACC,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC;EAEnC;EAEAC,gBAAgBA,CAAA;IACd,IAAI,IAAI,CAACtB,cAAc,KAAKlC,cAAc,CAACmC,GAAG,EAAE;MAC9C,IAAI,CAACD,cAAc,GAAGlC,cAAc,CAACyD,IAAI;MACzC,IAAI,CAAC3B,KAAK,CAAC4B,QAAQ,CAACzD,oBAAoB,CAAC;QAACiC,cAAc,EAAElC,cAAc,CAACyD;MAAI,CAAC,CAAC,CAAC;KACjF,MACI;MACH,IAAI,CAACvB,cAAc,GAAGlC,cAAc,CAACmC,GAAG;MACxC,IAAI,CAACL,KAAK,CAAC4B,QAAQ,CAACzD,oBAAoB,CAAC;QAACiC,cAAc,EAAElC,cAAc,CAACmC;MAAG,CAAC,CAAC,CAAC;;EAEnF;EACAgB,cAAcA,CAAA;IACZ,IAAI;MACA,IAAI,CAACpB,iBAAiB,CAAC4B,aAAa,CAACC,SAAS,GAAG,IAAI,CAAC7B,iBAAiB,CAAC4B,aAAa,CAACE,YAAY;KACrG,CAAC,OAAMC,GAAG,EAAE;EACf;EAEAC,WAAWA,CAAA;IACT,IAAI,CAAClC,OAAO,CAACkC,WAAW,CAAC,IAAI,CAACpB,WAAW,EAAE,IAAI,CAACT,cAAc,CAAC;IAC/D,IAAI,CAACS,WAAW,GAAG,EAAE;EACvB;EAAC,QAAAqB,CAAA,G;qBAtDUrC,aAAa,EAAAzB,EAAA,CAAA+D,iBAAA,CAAAC,EAAA,CAAAC,WAAA,GAAAjE,EAAA,CAAA+D,iBAAA,CAAAG,EAAA,CAAAC,KAAA;EAAA;EAAA,QAAAC,EAAA,G;UAAb3C,aAAa;IAAA4C,SAAA;IAAAC,SAAA,WAAAC,oBAAAC,EAAA,EAAAC,GAAA;MAAA,IAAAD,EAAA;;;;;;;;;;;;;;;QCf1BxE,EAAA,CAAAC,cAAA,aAAgC;QAIhBD,EAAA,CAAA0E,SAAA,aAEM;QACN1E,EAAA,CAAAQ,UAAA,IAAAmE,4BAAA,iBAmBM;QACN3E,EAAA,CAAAC,cAAA,UAAK;QAE0DD,EAAA,CAAA4E,UAAA,2BAAAC,sDAAA;UAAA,OAAiBJ,GAAA,CAAAZ,WAAA,EAAa;QAAA,EAAC,2BAAAiB,sDAAAC,MAAA;UAAA,OAAAN,GAAA,CAAAhC,WAAA,GAAAsC,MAAA;QAAA;QAAtF/E,EAAA,CAAAG,YAAA,EAAiH;QACjHH,EAAA,CAAAC,cAAA,iBAA4E;QAAxBD,EAAA,CAAA4E,UAAA,mBAAAI,gDAAA;UAAA,OAASP,GAAA,CAAAZ,WAAA,EAAa;QAAA,EAAC;QACvE7D,EAAA,CAAAE,MAAA,sBACJ;QAAAF,EAAA,CAAAG,YAAA,EAAS;QACTH,EAAA,CAAAC,cAAA,qBAAgE;QAA7CD,EAAA,CAAA4E,UAAA,oBAAAK,gDAAAF,MAAA;UAAA,OAAUN,GAAA,CAAAvB,cAAA,CAAA6B,MAAA,CAAsB;QAAA,EAAC;QAApD/E,EAAA,CAAAG,YAAA,EAAgE;QAChEH,EAAA,CAAAC,cAAA,kBAA6F;QAA/CD,EAAA,CAAA4E,UAAA,mBAAAM,gDAAA;UAAA,OAAAT,GAAA,CAAA5D,gBAAA,IAAA4D,GAAA,CAAA5D,gBAAA;QAAA,EAA8C;QAACb,EAAA,CAAAE,MAAA,yBAAiB;QAAAF,EAAA,CAAAG,YAAA,EAAS;QACvHH,EAAA,CAAAC,cAAA,kBAAwE;QAA7BD,EAAA,CAAA4E,UAAA,mBAAAO,gDAAA;UAAA,OAASV,GAAA,CAAAnB,gBAAA,EAAkB;QAAA,EAAC;QAACtD,EAAA,CAAAE,MAAA,IAAkB;QAAAF,EAAA,CAAAG,YAAA,EAAS;;;QA5BxFH,EAAA,CAAAI,SAAA,GAAW;QAAXJ,EAAA,CAAAW,UAAA,YAAA8D,GAAA,CAAA1C,QAAA,CAAW;QAsBiE/B,EAAA,CAAAI,SAAA,GAAyB;QAAzBJ,EAAA,CAAAW,UAAA,YAAA8D,GAAA,CAAAhC,WAAA,CAAyB;QAMxCzC,EAAA,CAAAI,SAAA,GAAkB;QAAlBJ,EAAA,CAAAK,iBAAA,CAAAoE,GAAA,CAAAzC,cAAA,CAAkB"},"metadata":{},"sourceType":"module","externalDependencies":[]}