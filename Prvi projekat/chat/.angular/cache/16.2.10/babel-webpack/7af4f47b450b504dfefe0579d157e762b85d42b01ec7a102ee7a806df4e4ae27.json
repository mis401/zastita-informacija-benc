{"ast":null,"code":"import { ElementRef } from '@angular/core';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./chat.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nconst _c0 = [\"scrollable\"];\nfunction ChatComponent_div_5_div_1_p_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 14);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const m_r2 = i0.ɵɵnextContext(2).$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(m_r2.crypto);\n  }\n}\nfunction ChatComponent_div_5_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 12)(1, \"div\", 13)(2, \"p\", 14);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(4, ChatComponent_div_5_div_1_p_4_Template, 2, 1, \"p\", 15);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const m_r2 = i0.ɵɵnextContext().$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(m_r2.text);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.toggleEncryption);\n  }\n}\nfunction ChatComponent_div_5_ng_template_2_p_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 19);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const m_r2 = i0.ɵɵnextContext(2).$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(m_r2.crypto);\n  }\n}\nfunction ChatComponent_div_5_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 16)(1, \"div\", 13)(2, \"p\", 17);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\", 14);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(6, ChatComponent_div_5_ng_template_2_p_6_Template, 2, 1, \"p\", 18);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const m_r2 = i0.ɵɵnextContext().$implicit;\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(m_r2.senderName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(m_r2.text);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r5.toggleEncryption);\n  }\n}\nfunction ChatComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, ChatComponent_div_5_div_1_Template, 5, 2, \"div\", 10);\n    i0.ɵɵtemplate(2, ChatComponent_div_5_ng_template_2_Template, 7, 3, \"ng-template\", null, 11, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const m_r2 = ctx.$implicit;\n    const _r4 = i0.ɵɵreference(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", m_r2.owner == true)(\"ngIfElse\", _r4);\n  }\n}\nexport class ChatComponent {\n  constructor(service) {\n    this.service = service;\n    this.myScrollContainer = new ElementRef('scrollable');\n    this.messages = [];\n    this.toggleEncryption = false;\n    this.messages$ = this.service.messageStream.subscribe(message => {\n      console.log(message);\n      this.messages.push(message);\n    });\n    this.messageText = '';\n    window.onbeforeunload = () => this.ngOnDestroy();\n  }\n  ngOnInit() {\n    this.service.connect();\n  }\n  ngOnDestroy() {\n    console.log(`Destroy pozvan`);\n    this.service.disconnect();\n  }\n  ngAfterViewChecked() {\n    this.scrollToBottom();\n  }\n  scrollToBottom() {\n    try {\n      this.myScrollContainer.nativeElement.scrollTop = this.myScrollContainer.nativeElement.scrollHeight;\n    } catch (err) {}\n  }\n  sendMessage() {\n    this.service.sendMessage(this.messageText);\n    this.messageText = '';\n  }\n  static #_ = this.ɵfac = function ChatComponent_Factory(t) {\n    return new (t || ChatComponent)(i0.ɵɵdirectiveInject(i1.ChatService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ChatComponent,\n    selectors: [[\"app-chat\"]],\n    viewQuery: function ChatComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.myScrollContainer = _t.first);\n      }\n    },\n    decls: 13,\n    vars: 2,\n    consts: [[1, \"h-full\", \"bg-gray-700\"], [1, \"min-h-screen\", \"chat\", \"flex\", \"flex-col-reverse\"], [1, \"inner-chat\"], [\"scrollable\", \"\"], [1, \"chat-card\"], [4, \"ngFor\", \"ngForOf\"], [1, \"input-poruke\", \"flex\", \"flex-row\"], [\"type\", \"text\", \"placeholder\", \"Poruka\", 1, \"w-full\", 3, \"ngModel\", \"keydown.enter\", \"ngModelChange\"], [\"type\", \"reset\", 1, \"bg-green-500\", \"mr-1\", \"ml-2\", 3, \"click\"], [1, \"bg-orange-500\", \"ml-1\", \"rounded-md\", 3, \"click\"], [\"class\", \"chat-msg-wrap sender\", 4, \"ngIf\", \"ngIfElse\"], [\"receiver\", \"\"], [1, \"chat-msg-wrap\", \"sender\"], [1, \"chat-msg\"], [2, \"margin-bottom\", \"0\"], [\"style\", \"margin-bottom: 0;\", 4, \"ngIf\"], [1, \"chat-msg-wrap\", \"receiver\"], [1, \"text-sm\", \"bg-lime-600/50\", \"rounded-sm\", \"pl-1\", \"pr-1\"], [\"class\", \"bg-lime-800/75 rounded-md\", \"style\", \"margin-bottom: 0;\", 4, \"ngIf\"], [1, \"bg-lime-800/75\", \"rounded-md\", 2, \"margin-bottom\", \"0\"]],\n    template: function ChatComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2, 3)(4, \"div\", 4);\n        i0.ɵɵtemplate(5, ChatComponent_div_5_Template, 4, 2, \"div\", 5);\n        i0.ɵɵelementStart(6, \"div\")(7, \"div\", 6)(8, \"input\", 7);\n        i0.ɵɵlistener(\"keydown.enter\", function ChatComponent_Template_input_keydown_enter_8_listener() {\n          return ctx.sendMessage();\n        })(\"ngModelChange\", function ChatComponent_Template_input_ngModelChange_8_listener($event) {\n          return ctx.messageText = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"button\", 8);\n        i0.ɵɵlistener(\"click\", function ChatComponent_Template_button_click_9_listener() {\n          return ctx.sendMessage();\n        });\n        i0.ɵɵtext(10, \" Po\\u0161alji \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"button\", 9);\n        i0.ɵɵlistener(\"click\", function ChatComponent_Template_button_click_11_listener() {\n          return ctx.toggleEncryption = !ctx.toggleEncryption;\n        });\n        i0.ɵɵtext(12, \"Enkriptovan tekst\");\n        i0.ɵɵelementEnd()()()()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngForOf\", ctx.messages);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngModel\", ctx.messageText);\n      }\n    },\n    dependencies: [i2.NgForOf, i2.NgIf, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgModel],\n    styles: [\"var[_ngcontent-%COMP%]   resource[_ngcontent-%COMP%];\\n\\n (()[_ngcontent-%COMP%]   =[_ngcontent-%COMP%] >  { // webpackBootstrap\\n\\n \\tvar __webpack_modules__ = ({\\n\\n\\n 820:\\n\\n\\n\\n\\n\\n (() => {\\n\\nthrow new Error(\\\"Module build failed (from ./node_modules/sass-loader/dist/cjs.js):\\\\nExpected expression.\\\\n   \\u2577\\\\n65 \\u2502     height: \\\\r\\\\n   \\u2502             ^\\\\n   \\u2575\\\\n  src\\\\\\\\app\\\\\\\\chat\\\\\\\\chat.component.scss 65:13  root stylesheet\\\");\\n\\n\\n })\\n\\n\\n \\t});\\n\\n\\n\\n \\t\\n\\n \\t// startup\\n\\n \\t// Load entry module and return exports\\n\\n \\t// This entry module doesn't tell about it's top-level declarations so it can't be inlined\\n\\n \\tvar __webpack_exports__ = {};\\n\\n \\t__webpack_modules__[820]();\\n\\n \\tresource = __webpack_exports__;\\n\\n \\t\\n\\n })()\\n;\"]\n  });\n}","map":{"version":3,"names":["ElementRef","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵadvance","ɵɵtextInterpolate","m_r2","crypto","ɵɵtemplate","ChatComponent_div_5_div_1_p_4_Template","text","ɵɵproperty","ctx_r3","toggleEncryption","ChatComponent_div_5_ng_template_2_p_6_Template","senderName","ctx_r5","ChatComponent_div_5_div_1_Template","ChatComponent_div_5_ng_template_2_Template","ɵɵtemplateRefExtractor","owner","_r4","ChatComponent","constructor","service","myScrollContainer","messages","messages$","messageStream","subscribe","message","console","log","push","messageText","window","onbeforeunload","ngOnDestroy","ngOnInit","connect","disconnect","ngAfterViewChecked","scrollToBottom","nativeElement","scrollTop","scrollHeight","err","sendMessage","_","ɵɵdirectiveInject","i1","ChatService","_2","selectors","viewQuery","ChatComponent_Query","rf","ctx","ChatComponent_div_5_Template","ɵɵlistener","ChatComponent_Template_input_keydown_enter_8_listener","ChatComponent_Template_input_ngModelChange_8_listener","$event","ChatComponent_Template_button_click_9_listener","ChatComponent_Template_button_click_11_listener"],"sources":["C:\\Users\\MihajloBencun\\Desktop\\Faks\\Zastita informacija\\Prvi projekat\\chat\\src\\app\\chat\\chat.component.ts","C:\\Users\\MihajloBencun\\Desktop\\Faks\\Zastita informacija\\Prvi projekat\\chat\\src\\app\\chat\\chat.component.html"],"sourcesContent":["import { AfterViewChecked, Component, ElementRef, OnDestroy, OnInit, ViewChild } from '@angular/core';\nimport { ChatService } from './chat.service';\nimport { Message } from '../models/message.dto';\n\n@Component({\n  selector: 'app-chat',\n  templateUrl: './chat.component.html',\n  styleUrls: ['./chat.component.scss']\n})\nexport class ChatComponent implements OnInit, OnDestroy, AfterViewChecked{\n  @ViewChild('scrollable') private myScrollContainer: ElementRef = new ElementRef('scrollable');\n  messages: Message[] = [];\n  toggleEncryption: boolean = false;\n  messages$ = this.service.messageStream.subscribe((message) => {\n    console.log(message);\n    this.messages.push(message);\n  });\n  messageText : string = '';\n  constructor(private service: ChatService) {\n    window.onbeforeunload = () => this.ngOnDestroy();\n   }\n  ngOnInit(){\n    this.service.connect();\n    \n  }\n  ngOnDestroy(): void {\n    console.log(`Destroy pozvan`);\n    this.service.disconnect();\n  }\n  ngAfterViewChecked(): void {\n    this.scrollToBottom();\n  }\n  scrollToBottom():void {\n    try {\n        this.myScrollContainer.nativeElement.scrollTop = this.myScrollContainer.nativeElement.scrollHeight;\n    } catch(err) { }                 \n  }\n\n  sendMessage(){\n    this.service.sendMessage(this.messageText);\n    this.messageText = '';\n  }\n}\n","<div class=\"h-full bg-gray-700\">\n    <div class=\"min-h-screen chat flex flex-col-reverse\">\n        <div #scrollable class=\"inner-chat\">\n            <div class=\"chat-card\">\n                <div *ngFor=\"let m of messages\">\n                    <div *ngIf=\"m.owner==true; else receiver\" class=\"chat-msg-wrap sender\">\n                        <div class=\"chat-msg\">\n                            <p style=\"margin-bottom: 0;\">{{m.text}}</p>\n                            <p *ngIf=\"toggleEncryption\" style=\"margin-bottom: 0;\">{{m.crypto}}</p>\n                        </div>\n                    </div>\n                    <ng-template #receiver>\n                        <div class=\"chat-msg-wrap receiver\">\n                            <div class=\"chat-msg\">\n                                <p class=\"text-sm bg-lime-600/50 rounded-sm pl-1 pr-1\">{{m.senderName}}</p>\n                                <p style=\"margin-bottom: 0;\">{{m.text}}</p>\n                                <p *ngIf=\"toggleEncryption\" class=\"bg-lime-800/75 rounded-md\" style=\"margin-bottom: 0;\">{{m.crypto}}</p>\n                            </div>\n                        </div>\n                    </ng-template>\n                </div>\n                <div>\n                    <div class=\"input-poruke flex flex-row\">\n                        <input type=\"text\" class=\"w-full\" placeholder=\"Poruka\" (keydown.enter)=\"sendMessage()\" [(ngModel)]=\"messageText\">\n                        <button class=\"bg-green-500 mr-1 ml-2\" type=\"reset\" (click)=\"sendMessage()\">\n                            Pošalji\n                        </button>\n                        <button class=\"bg-orange-500 ml-1 rounded-md\" (click)=\"toggleEncryption = !toggleEncryption\">Enkriptovan tekst</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}